modulex.add("dd/plugin/scroll",["util","node","dd","base"],function(t,e,o){var n,l=t("util"),r=t("node"),i=t("dd"),f=t("base");n=function(t){var e=l,o=r,n=i,u=f,c=n.DDM,d=window,g=".-ks-dd-scroll"+e.now(),a=[10,10],s=100,p=[20,20],h=e.isWindow;return t=u.extend({pluginId:"dd/plugin/scroll",getRegion:function(t){return h(t[0])?{width:t.width(),height:t.height()}:{width:t.outerWidth(),height:t.outerHeight()}},getOffset:function(t){return h(t[0])?{left:t.scrollLeft(),top:t.scrollTop()}:t.offset()},getScroll:function(t){return{left:t.scrollLeft(),top:t.scrollTop()}},setScroll:function(t,e){t.scrollLeft(e.left),t.scrollTop(e.top)},pluginDestructor:function(t){t.detach(g)},pluginInitializer:function(t){function o(){if(h(d[0]))return 0;var e=t.mousePos,o=c.region(d);return c.inRegion(o,e)?0:(clearTimeout(v),v=0,1)}function n(n){if(!n.fake&&!o()){i=n,f=e.clone(t.mousePos);var l=u.getOffset(d);f.left-=l.left,f.top-=l.top,v||r()}}function l(){clearTimeout(v),v=null}function r(){if(!o()){var n=u.getRegion(d),l=n.width,c=n.height,g=u.getScroll(d),w=e.clone(g),T=f.top-c,m=!1;T>=-p[1]&&(g.top+=a[1],m=!0);var S=f.top;S<=p[1]&&(g.top-=a[1],m=!0);var R=f.left-l;R>=-p[0]&&(g.left+=a[0],m=!0);var k=f.left;k<=p[0]&&(g.left-=a[0],m=!0),m?(u.setScroll(d,g),v=setTimeout(r,s),i.fake=!0,h(d[0])&&(g=u.getScroll(d),i.left+=g.left-w.left,i.top+=g.top-w.top),t.get("move")&&t.get("node").offset(i),t.fire("drag",i)):v=null}}var i,f,u=this,d=u.get("node"),a=u.get("rate"),p=u.get("diff"),v=null;t.on("drag"+g,n),t.on("dragstart"+g,function(){c.cacheWH(d)}),t.on("dragend"+g,l)}},{ATTRS:{node:{valueFn:function(){return o(d)},setter:function(t){return o(t)}},rate:{value:a},diff:{value:p}}})}(),o.exports=n});