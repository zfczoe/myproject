modulex.add("toolbar",["component/container","component/extension/delegate-children","util","node"],function(e,t,n){var a,l=e("component/container"),i=e("component/extension/delegate-children"),r=e("util"),o=e("node");a=function(e){function t(e,t,n){var a=n.get("children"),l=0,i=a.length;if(void 0===e&&(e=1===t?0:i-1,!a[e].get("disabled")))return a[e];do l++,e=(e+i+t)%i;while(i>l&&a[e].get("disabled"));return l!==i?a[e]:null}function n(e){var t=this;e.newVal?t.set("expandedItem",null):t.set("expandedItem",e.target)}function a(e){var t,n,a=this,l=e.target;a!==l&&(l.isMenuItem||l.isButton)&&(e.newVal?(n=a.get("children"),(t=a.get("expandedItem"))&&h.inArray(l,n)&&a.set("expandedItem",l.isMenuButton?l:null),a.set("highlightedItem",l)):e.byPassSetToolbarHighlightedItem||a.set("highlightedItem",null))}function d(e){var t,n,a=e.get("children");for(t=0;t<a.length;t++)if(n=a[t],n.get("highlighted")||n.isMenuButton&&!n.get("collapsed"))return n;return null}var s=l,u=i,h=r,c=o.Event.KeyCode;return e=s.extend([u],{beforeCreateDom:function(e){e.elAttrs.role="toolbar"},bindUI:function(){var e=this;e.on("afterCollapsedChange",n,e),e.on("afterHighlightedChange",a,e)},handleBlurInternal:function(e){var t,n=this;n.callSuper(e),n.set("expandedItem",null),(t=n.get("highlightedItem"))&&t.set("highlighted",!1)},getNextItemByKeyDown:function(e,n){var a=this,l=a.get("children"),i=n&&h.indexOf(n,l);if(n&&n.handleKeyDownInternal(e))return!0;if(e.shiftKey||e.ctrlKey||e.metaKey||e.altKey)return!1;switch(e.keyCode){case c.ESC:return a.getKeyEventTarget().fire("blur"),!0;case c.HOME:n=t(void 0,1,a);break;case c.END:n=t(void 0,-1,a);break;case c.UP:n=t(i,-1,a);break;case c.LEFT:n=t(i,-1,a);break;case c.DOWN:n=t(i,1,a);break;case c.RIGHT:n=t(i,1,a);break;default:return!1}return n},handleKeyDownInternal:function(e){var t=this,n=d(t),a=t.getNextItemByKeyDown(e,n);return"boolean"==typeof a?a:(a&&a.set("highlighted",!0),!0)},_onSetHighlightedItem:function(e,t){var n,a,l=this,i=t&&t.prevVal,r=l.get("children"),o=l.el;i&&h.inArray(i,r)&&i.set("highlighted",!1,{data:{byPassSetToolbarHighlightedItem:1}}),e?(o.ownerDocument.activeElement!==o&&l.focus(),a=e.el,n=a.id,n||(a.id=n=h.guid("ks-toolbar-item")),o.setAttribute("aria-activedescendant",n)):o.setAttribute("aria-activedescendant","")},_onSetExpandedItem:function(e,t){t&&t.prevVal&&t.prevVal.set("collapsed",!0),e&&e.set("collapsed",!1)}},{xclass:"toolbar",version:"1.0.1",ATTRS:{allowTextSelection:{value:!0},focusable:{value:!0},handleGestureEvents:{value:!0},highlightedItem:{},expandedItem:{},defaultChildCfg:{valueFn:function(){return{xclass:"button",handleGestureEvents:!1,focusable:!1}}}}})}(),n.exports=a});